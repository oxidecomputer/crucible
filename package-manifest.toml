[package.crucible-svc]
service_name = "crucible-svc"
source.type = "local"
source.rust.binary_names = ["crucible-agent", "crucible-downstairs"]
source.rust.release = true
source.paths = [
  { from = "agent/smf", to = "/var/svc/manifest/site/crucible" },
  { from = "agent/downstairs_method_script.sh", to = "/opt/oxide/lib/svc/manifest/crucible/downstairs.sh" },
]
output.type = "zone"
output.intermediate_only = true

[package.crucible]
service_name = "crucible"
only_for_targets.image = "standard"
source.type = "composite"
source.packages = [ "crucible-svc.tar.gz", "zone-network-setup.tar.gz" ]
output.type = "zone"

[package.crucible-pantry-svc]
service_name = "pantry-svc"
source.type = "local"
source.rust.binary_names = ["crucible-pantry"]
source.rust.release = true
source.paths = [
  { from = "pantry/smf/pantry.xml", to = "/var/svc/manifest/site/crucible/pantry.xml" },
]
output.type = "zone"
output.intermediate_only = true

[package.crucible-pantry]
service_name = "crucible-pantry"
only_for_targets.image = "standard"
source.type = "composite"
source.packages = [ "crucible-pantry-svc.tar.gz", "zone-network-setup.tar.gz" ]
output.type = "zone"
